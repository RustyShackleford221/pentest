#!/bin/bash

################ Set up some variables ################
HOSTNAME=workstation01
################  Done with variables  ################

# Change the password
passwd

# Change the hostname (kali looks suspicious on a network)
echo $HOSTNAME > /etc/hostname
hostname $HOSTNAME

# General updates
apt update; apt upgrade -y;

# Get Metasploit ready
systemctl enable postgresql; systemctl start postgresql
systemctl restart metasploit
msfdb init
echo exit | msfconsole                                                 # sets up the needed .msf4 folder
echo "spool /root/msf_console.log" > /root/.msf4/msfconsole.rc         # enables logging of all msf activity

# Set up Docker
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
echo "deb https://download.docker.com/linux/debian stretch stable" >> /etc/apt/sources.list 
apt update
apt install docker-ce -y

# Install node-js
apt install nodejs npm -y

# Install aquatone for bounty recon
gem install aquatone

# Set directory to store new stuff
mkdir /root/scripts

# Grab some good open source scripts, etc
cd /root/scripts
git clone https://github.com/danielmiessler/SecLists.git
git clone https://github.com/jhaddix/domain; mv ./domain ./enumall
git clone https://github.com/wireghoul/graudit.git

# TOOL - HTTPScreenShot
apt install python-selenium -y
git clone https://github.com/breenmachine/httpscreenshot.git /opt/httpscreenshot
cd /opt/httpscreenshot
chmod 700 install-dependencies.sh && ./install-dependencies.sh

# TOOL - smbexec
git clone https://github.com/pentestgeek/smbexec.git /opt/smbexec
cd /opt/smbexec && ./install.sh                                     # Note: this is an interactive installer
./install.sh                                                        # Need to run second time to compile binaries

# TOOL - gitrob
git clone https://github.com/michenriksen/gitrob.git /opt/gitrob
gem install bundler
su postgres
createuser -s gitrob --pwprompt
createdb -O gitrob gitrob
exit
cd /opt/gitrob/bin
gem install gitrob

# TOOL - CMSmap
git clone https://github.com/Dionach/CMSmap /opt/CMSmap

# TOOL - EyeWitness
apt install eyewitness -y

# TOOL - printer exploits
git clone https://github.com/MooseDojo/praedasploit /opt/praedasploit

# TOOL - discovery scripts
git clone https://github.com/leebaird/discover.git /opt/discover
cd /opt/discover && ./update.sh

# TOOL - beef
cd /opt/
wget https://raw.githubusercontent.com/beefproject/beef/a6a7536e/install-beef
chmod 700 ./install-beef
echo y | ./install-beef
rm -f ./install-beef

# TOOL - flash decompiler
wget https://www.free-decompiler.com/flash/download/ffdec_10.0.0.deb
apt install ./ffdec_10.0.0.deb -y                                                       # for editing the swf packages
rm -f ./ffdec_10.0.0.deb
mkdir /root/scripts/flash-stuff; cd /root/scripts/flash-stuff
wget https://fpdownload.macromedia.com/get/flashplayer/updaters/27/playerglobal27_0.swc # required to edit scripts inline
